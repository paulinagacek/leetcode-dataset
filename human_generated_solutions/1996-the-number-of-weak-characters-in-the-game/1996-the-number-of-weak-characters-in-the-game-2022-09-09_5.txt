class Solution:
    def numberOfWeakCharacters(self, properties: List[List[int]]) -> int:
        properties.sort(key=itemgetter(0), reverse=True)

        cur_attack = properties[0][0]
        prev_best_defense = 0  # best defense among characters with strictly greater attack
        cur_best_defense = 0  # best defense among all characters observed so far

        res = 0
        
        for attack, defense in properties:
            if attack != cur_attack:
                # this means that all characters observed so far have attack strictly greater.
				# so we merge latest best defense update into the value we use for comparison.
				# best defense can really only go up, so prev_best_defense is guaranteed to be
				# less or equal than cur_best_defense
				prev_best_defense = cur_best_defense
                cur_attack = attack
            
            cur_best_defense = max(cur_best_defense, defense)
			
			if defense < prev_best_defense:
                res += 1
        
        return res