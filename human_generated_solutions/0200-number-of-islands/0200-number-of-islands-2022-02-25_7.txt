from collections import defaultdict

LAND = "1"
WATER = "0"

LEFT = (0, -1)
RIGHT = (0, 1)
UP = (-1, 0)
DOWN = (1, 0)

DIRECTIONS = (LEFT, RIGHT, UP, DOWN)

class Solution:
    def within_bounds(self, x, y):
        return 0 <= x < self.rows and 0 <= y < self.cols
    
    def is_land(self, x, y):
        return self.grid[x][y] == LAND
    
    def not_visited(self, x, y):
        return self.visited[(x, y)] == False
        
    def bfs(self, row, col):
        queue = [(row, col)]
        while queue:
            x, y = queue.pop(0)
            for dx, dy in DIRECTIONS:
                new_x = x + dx
                new_y = y + dy
                
                if not self.within_bounds(new_x, new_y):
                    continue

                if self.is_land(new_x, new_y) and self.not_visited(new_x, new_y):
                    queue.append((new_x, new_y))
                    self.visited[(new_x, new_y)] = True

    def numIslands(self, grid: List[List[str]]) -> int:
        self.rows = len(grid)
        self.cols = len(grid[0])
        self.grid = grid
        self.visited = defaultdict(lambda: False)
        count = 0

        for row in range(self.rows):
            for col in range(self.cols):
                if not self.is_land(row, col):
                    continue
                
                elif (row, col) in self.visited:
                    continue
                
                self.bfs(row, col)
                count += 1
        
        return count