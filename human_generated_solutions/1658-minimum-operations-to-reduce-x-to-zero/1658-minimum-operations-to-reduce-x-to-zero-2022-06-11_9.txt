def binary_search(arr, left, right, target):
    while left <= right:
        mid = (left + right) >> 1
        
        value = arr[mid]
        if value == target:
            return mid
    
        elif value < target:
            left = mid + 1
        
        else:
            right = mid - 1
        
    return -1

class Solution:
    def minOperations(self, nums: List[int], target: int) -> int:
        length = len(nums)

        prefix_sum = [0] * length
        suffix_sum = [0] * length
        
        prefix_sum[0] = nums[0]
        
        for index in range(1, length):
            prefix_sum[index] += prefix_sum[index-1] + nums[index]
        
        suffix_sum[-1] = nums[-1]
        
        for index in range(length-2, -1, -1):
            suffix_sum[index] = suffix_sum[index+1] + nums[index]
        
        answer = math.inf

        if target in prefix_sum: answer = min(answer, prefix_sum.index(target)+1)
        if target in suffix_sum: answer = min(answer, length - suffix_sum.index(target))
            
        for suffix_index in range(length-1, -1, -1):
            suffix_value = suffix_sum[suffix_index]
            prefix_index = binary_search(prefix_sum, 0, length-1, target-suffix_value)

            if prefix_index != -1 and prefix_index < suffix_index:
                current = (prefix_index+1) + (length-suffix_index) # prefix_index + 1 because arrays are 0 indexed
                answer = min(answer, current)
        
        return answer if answer != math.inf else -1