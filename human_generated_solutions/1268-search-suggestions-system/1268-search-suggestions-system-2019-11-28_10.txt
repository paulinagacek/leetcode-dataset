# Dev: Chumicat
# Date: 2019/11/28
# Submission: https://leetcode.com/submissions/detail/282213232/
# (Time, Space) Complexity : O(mnlog(n)), O(1)

class Solution:
    def suggestedProducts(self, products: List[str], searchWord: str) -> List[List[str]]:
        """
        :type products: List[str]
        :type searchWord: str
        :rtype: List[List[str]]
        """
        # After sort, product list will follow alphabetic order
        products.sort()
        
        # Use two iter to hold the target words between
        start, end, ret = 0, len(products)-1, []
        for n_th, c in enumerate(searchWord):
            # Check between start and end to prevent unusable move
            # Check lenth of current "product string" to prevent "search word" longer than "product string"
            while start <= end and (products[start][n_th] < c if len(products[start])>n_th else True):
                start += 1
            while start <= end and (products[end][n_th] > c if len(products[end])>n_th else True):
                end -= 1
                
            # Append at most three element array
            ret.append(products[start:start+3] if end > start+1 else products[start:end+1])
        return ret