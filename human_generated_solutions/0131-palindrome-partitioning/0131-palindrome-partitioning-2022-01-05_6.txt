class Solution:
    def partition(self, s: str) -> List[List[str]]:
        l = len(s)
        
        def isPalindrom(s):
            return s == s[::-1]
        
        @cache
        def rec(start):
            if start == l:
                return []

            res = []
            for i in range(start + 1, l + 1):
                sub = s[start:i]

                if isPalindrom(sub):
                    subres = rec(i)
                    if not subres:
                        res.append(deque([sub]))
                    else:
                        for arr in subres:
                            copy = arr.copy()
                            copy.appendleft(sub)
                            res.append(copy)
    
            return res
            
        return rec(0)