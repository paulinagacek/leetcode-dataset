class Solution:
    def smallestSubarrays(self, nums: List[int]) -> List[int]:
        def findClosest(ind,arr):
            if ind>arr[-1]:
                return 0
            idx=bisect.bisect_left(arr,ind)
            return arr[idx]-ind
        binary=[]
        n=len(nums)
        for i in range(n):
            temp=[0 for i in range(32)]
            for bit in range(32):
                if nums[i]&(1<<bit):
                    temp[31-bit]=1
            binary.append(temp)
        hmap=defaultdict(list)
        for i in range(32):
            for j in range(n):
                if binary[j][i]==1:
                    hmap[i].append(j)
        ans=[0 for i in range(n)]
        for i in range(n):
            maxVal=0
            for j in range(32):
                if j in hmap:
                    val=findClosest(i,hmap[j])
                    maxVal=max(maxVal,val)
                else:
                    continue
            ans[i]=maxVal+1
        return ans