class Solution:
    ans = float(\'-inf\')
    
    def longestCycle(self, edges: List[int]) -> int:
        ancestors = {}
        visited = set()
    
        def dfs(node, increasing_id):
            neighbor = edges[node]
            if neighbor == -1:
                return
            
            if neighbor in ancestors:
                self.ans = max(self.ans, increasing_id - ancestors[neighbor])
            
            if neighbor in visited:
                return
            
            visited.add(neighbor)
            
            ancestors[neighbor] = increasing_id
            dfs(neighbor, increasing_id + 1)
            ancestors.pop(neighbor)
            
        n = len(edges)
        for node in range(n):
            if node == -1: continue
            if node in visited: continue
            
            visited.add(node)
            ancestors[node] = 0 
            dfs(node, 1)
            ancestors.pop(node)
            
        return self.ans if self.ans != float(\'-inf\') else -1