class Solution:
    def flatten(self, head: \'Node\') -> \'Node\':
        
        def helper(head) -> \'None\':
            
            prev, current_node = None, head
            
            while current_node:
                
                if current_node.child:
                    
                    # flatten child linked list
                    current_child, current_tail = current_node.child, helper(current_node.child)
                    
                    # After next level flattening is completed
                    # Handle for the concatenation between current linked list and child linked list
                    
                    # current node\'s child points to None after flattening
                    current_node.child = None
                    
                    ## Update the linkage between original next and current tail                    
                    original_next = current_node.next
                    
                    if original_next: 
                        original_next.prev = current_tail                    
                    
                    current_tail.next = original_next
                            
                    ## Update the linkage between current node and current child
                    current_node.next, current_child.prev = current_child, current_node
                    
                    # update prev and cur, move to next position
                    prev, current_node = current_tail, original_next
                    
                    
                else:
                    
                    # update prev and cur, move to next position
                    prev, current_node = current_node, current_node.next
            
            
            # return tail node
            return prev
        
	# ------------------------------------------------------------------------------

        helper(head)
        
        return head