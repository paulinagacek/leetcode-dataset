class TimeMap:

    def __init__(self):
        """
        Initialize your data structure here
        """
        self.d = collections.defaultdict(list)


    def set(self, key: str, value: str, timestamp: int) -> None:  # O(1)
        self.d[key].append((timestamp, value))
    

    def get(self, key: str, timestamp: int) -> str: # -- O(logN)
        # base case
        if key not in self.d or not self.d:
            return ""
        
        # key exists, check valid timestamps
        lst = self.d[key]
        if lst[-1][0] <= timestamp:
            return lst[-1][1]
        if lst[0][0] > timestamp:
            return ""
        
        # otherwise, we perform binary search to find the timestamp
        L, R = 0, len(lst) -1
        while L<R:
            mid=L+(R-L)//2
            t = lst[mid][0]
            if timestamp == t:
                return lst[mid][1]
            if timestamp > t:
                L = mid+1
            else:
                R = mid

        return lst[L-1][1]