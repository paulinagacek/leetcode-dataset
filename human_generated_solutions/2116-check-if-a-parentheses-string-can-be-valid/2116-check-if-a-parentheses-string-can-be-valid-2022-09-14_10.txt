class Solution:
    def canBeValid(self, s: str, locked: str) -> bool:
        n = len (s)
        if n % 2 == 1:
            return False
        
        min_closed = 0
        max_closed = 0
        
        for i, ch in enumerate (s):
            if locked[i] == \'1\':
                if ch == \'(\':
                    min_closed += 1
                    max_closed += 1
                else:
                    min_closed = max (0, min_closed - 1)
                    max_closed -= 1
                    
                    if max_closed < 0:
                        return False
                    
            else:
                min_closed = max (0, min_closed - 1)
                max_closed += 1
                    
        return min_closed == 0