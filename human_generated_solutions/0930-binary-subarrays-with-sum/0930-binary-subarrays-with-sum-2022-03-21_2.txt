class Solution:
    def numSubarraysWithSum(self, nums: List[int], goal: int) -> int:
        
        def at_most(k):
            
            # note the case for example [0, 0, 0, 0, 0], k = -1
            # then left pointer will finally go to the index 5, out of range
            # i will stay at index 0
            if k < 0:
                return 0
            
            res = 0
            left = 0
            summ = 0
            
            for i in range(len(nums)):
                
                # 1, in
                cur = nums[i]
                summ += cur
                
                # 2, out
                while summ > k:
                    
                    summ -= nums[left]
                    left += 1
                
                # 3, compute
                res += i - left + 1
            
            return res
        
        return at_most(goal) - at_most(goal-1)