class Solution:
    def recoverTree(self, root: TreeNode) -> None:
        first = None
        prev = TreeNode(float('-inf'))
        second = None
        curr = root
        while curr:
            if curr.left:
                temp = curr.left
                while temp.right and temp.right != curr:
                    temp = temp.right
                if temp.right is None:
                    temp.right = curr
                    curr = curr.left
                else:
                    if prev.val > curr.val:
                        if first is None:
                            first = prev
                        second = curr
                    prev = curr
                    temp.right = None
                    curr = curr.right
            else:
                if prev.val > curr.val:
                    if first is None:
                        first = prev
                    second = curr
                prev = curr
                curr = curr.right
        first.val, second.val = second.val, first.val
