class Solution:
    def maxProduct(self, nums: List[int]) -> int:
        if not nums:
            return 0
        
        # res stores the global maximum product found so far
        # cur_max and cur_min store the maximum and minimum products ending at the current index
        res = cur_max = cur_min = nums[0]
        
        for i in range(1, len(nums)):
            n = nums[i]
            
            # When multiplied by a negative number, the maximum product becomes the minimum and vice-versa
            if n < 0:
                cur_max, cur_min = cur_min, cur_max
            
            # Update current max and min products ending at the current index
            cur_max = max(n, n * cur_max)
            cur_min = min(n, n * cur_min)
            
            # Update the global maximum product
            res = max(res, cur_max)
            
        return res
