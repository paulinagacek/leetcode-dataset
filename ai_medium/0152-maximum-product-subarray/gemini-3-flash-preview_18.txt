class Solution:
    def maxProduct(self, nums: List[int]) -> int:
        if not nums:
            return 0
        
        # Initialize our result, current max product ending at i, and current min product ending at i.
        # We start with the first element of the array.
        res = cur_max = cur_min = nums[0]
        
        # Iterate through the array starting from the second element.
        for i in range(1, len(nums)):
            num = nums[i]
            
            # When we multiply a number by the current maximum and minimum products,
            # we get two new potential values for our maximum and minimum.
            # However, the number itself might also be a candidate for starting a new subarray.
            cand1 = num * cur_max
            cand2 = num * cur_min
            
            # Update current max and min products ending at the current position.
            # We must use the values before they are updated for these calculations.
            cur_max = max(num, cand1, cand2)
            cur_min = min(num, cand1, cand2)
            
            # Update the global result if the new current maximum is higher.
            if cur_max > res:
                res = cur_max
                
        return res
