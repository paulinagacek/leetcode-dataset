from typing import Optional
class Solution:
    def cloneGraph(self, node: Optional['Node']) -> Optional['Node']:
        if not node: return node
        
        old_to_new = {}
        new_graph = Node(node.val)
        old_to_new[node] = new_graph
        
        queue = [node]
        while queue:
            old_node = queue.pop(0)
            for neighbor in old_node.neighbors:
                if neighbor not in old_to_new:
                    new_neighbor = Node(neighbor.val)
                    old_to_new[neighbor] = new_neighbor
                    queue.append(neighbor)
                old_to_new[old_node].neighbors.append(old_to_new[neighbor])
        
        return new_graph
