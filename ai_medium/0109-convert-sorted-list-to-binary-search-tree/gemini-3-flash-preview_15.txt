class Solution:
    def sortedListToBST(self, head: Optional[ListNode]) -> Optional[TreeNode]:
        # Count the total number of nodes in the linked list
        n = 0
        curr = head
        while curr:
            n += 1
            curr = curr.next
        
        # current_list_node will track our progress through the linked list
        # during an in-order traversal
        self.current_list_node = head
        
        def convert(size):
            if size <= 0:
                return None
            
            # Recursively build the left subtree with the first half of the nodes
            left_child = convert(size // 2)
            
            # Use the current linked list node as the root of the current subtree
            root = TreeNode(self.current_list_node.val)
            root.left = left_child
            
            # Advance to the next node in the linked list
            self.current_list_node = self.current_list_node.next
            
            # Recursively build the right subtree with the remaining nodes
            root.right = convert(size - size // 2 - 1)
            
            return root
        
        # Start the conversion process for the entire range of nodes
        return convert(n)
