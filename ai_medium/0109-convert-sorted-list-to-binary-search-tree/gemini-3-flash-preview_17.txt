class Solution:
    def sortedListToBST(self, head: Optional[ListNode]) -> Optional[TreeNode]:
        # Step 1: Convert the singly-linked list into an array for O(1) random access
        vals = []
        curr = head
        while curr:
            vals.append(curr.val)
            curr = curr.next
        
        # Step 2: Recursive helper function to build the height-balanced BST
        def build_bst(left: int, right: int) -> Optional[TreeNode]:
            # Base case: if the range is invalid
            if left > right:
                return None
            
            # Pick the middle element of the current range as the root
            mid = (left + right) // 2
            root = TreeNode(vals[mid])
            
            # Recursively build the left and right subtrees
            # Picking the middle element ensures the tree remains height-balanced
            root.left = build_bst(left, mid - 1)
            root.right = build_bst(mid + 1, right)
            
            return root
        
        # Build the BST from the entire range of values
        return build_bst(0, len(vals) - 1)
