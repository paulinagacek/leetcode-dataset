class Solution:
    def findRepeatedDnaSequences(self, s: str) -> List[str]:
        n = len(s)
        if n < 10:
            return []
        
        enc = {'A': 0, 'C': 1, 'G': 2, 'T': 3}
        mask = (1 << 20) - 1  # keep last 20 bits (10 chars * 2 bits)
        
        x = 0
        for i in range(10):
            x = (x << 2) | enc[s[i]]
        
        seen = {x}
        added = set()
        res = []
        
        for i in range(10, n):
            x = ((x << 2) & mask) | enc[s[i]]
            if x in seen:
                if x not in added:
                    res.append(s[i-9:i+1])
                    added.add(x)
            else:
                seen.add(x)
        
        return res
