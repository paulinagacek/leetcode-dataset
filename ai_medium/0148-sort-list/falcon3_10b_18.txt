class Solution:
    def sortList(self, head: ListNode) -> ListNode:
        if not head or not head.next:
            return head
        
        def partition(node):
            pivot = node.val
            less_head, less_tail = None, None
            greater_head, greater_tail = None, None
            
            while node:
                if node.val < pivot:
                    if not less_head:
                        less_head = less_tail = ListNode(node.val)
                    else:
                        less_tail.next = ListNode(node.val)
                        less_tail = less_tail.next
                else:
                    if not greater_head:
                        greater_head = greater_tail = ListNode(node.val)
                    else:
                        greater_tail.next = ListNode(node.val)
                        greater_tail = greater_tail.next
                
                node = node.next
            
            if less_tail:
                less_tail.next = partition(less_head.next)
            if greater_tail:
                greater_tail.next = partition(greater_head.next)
            
            return less_head if less_head else greater_head
        
        return partition(head)
