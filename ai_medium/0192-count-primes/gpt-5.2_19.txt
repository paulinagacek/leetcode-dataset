class Solution:
    def countPrimes(self, n: int) -> int:
        if n <= 2:
            return 0

        # Sieve of Eratosthenes for odd numbers only
        size = n // 2  # represents odds: number (2*i + 1), i=0..size-1
        is_prime = bytearray(b"\x01") * size
        is_prime[0] = 0  # 1 is not prime

        limit = int(n ** 0.5)
        i = 1
        while (2 * i + 1) <= limit:
            if is_prime[i]:
                p = 2 * i + 1
                start = (p * p) // 2
                step = p
                is_prime[start:size:step] = b"\x00" * (((size - 1 - start) // step) + 1)
            i += 1

        return 1 + sum(is_prime)  # +1 for prime number 2
