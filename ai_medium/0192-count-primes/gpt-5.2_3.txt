class Solution:
    def countPrimes(self, n: int) -> int:
        if n <= 2:
            return 0
        if n <= 3:
            return 1  # only 2

        size = n // 2  # represent odd numbers only: index i -> number 2*i + 1
        is_prime = bytearray(b"\x01") * size
        is_prime[0] = 0  # 1 is not prime

        limit = int(n ** 0.5)
        for p in range(3, limit + 1, 2):
            if is_prime[p // 2]:
                start = (p * p) // 2
                step = p
                is_prime[start:size:step] = b"\x00" * (((size - 1 - start) // step) + 1)

        return is_prime.count(1) + 1  # +1 for prime number 2
