from typing import List

class Solution:
    def restoreIpAddresses(self, s: str) -> List[str]:
        result = []
        self.backtrack(s, 0, [], result)
        return result
    
    def backtrack(self, s: str, start: int, path: List[str], result: List[str]):
        if len(path) == 4 and start == len(s):
            result.append('.'.join(path))
            return
        if len(path) >= 4:
            return
        
        for length in range(1, 4):
            if start + length > len(s):
                break
            
            segment = s[start:start + length]
            if (length == 3 and int(segment) > 255) or (segment[0] == '0' and len(segment) > 1):
                continue
            
            self.backtrack(s, start + length, path + [segment], result)
