class Solution:
    def restoreIpAddresses(self, s: str) -> List[str]:
        """
        Solves the problem of finding all valid IP addresses that can be formed
        by inserting dots into the given string of digits.
        """
        n = len(s)
        # An IP address must have between 4 and 12 digits (inclusive).
        if n < 4 or n > 12:
            return []
        
        res = []
        
        def backtrack(start: int, path: List[str]):
            # Base case: if we have partitioned exactly 4 integers
            if len(path) == 4:
                # If all characters in the string are used, it's a valid IP address
                if start == n:
                    res.append(".".join(path))
                return
            
            # Pruning: if remaining digits are more than what 4 - len(path) parts can hold
            remaining_parts = 4 - len(path)
            remaining_digits = n - start
            if remaining_digits > remaining_parts * 3 or remaining_digits < remaining_parts:
                return

            # Try taking 1, 2, or 3 digits for the next part of the IP
            for length in range(1, 4):
                if start + length <= n:
                    segment = s[start : start + length]
                    
                    # Rule: cannot have leading zeros unless the integer is "0"
                    if length > 1 and segment[0] == '0':
                        continue
                    
                    # Rule: each integer must be between 0 and 255
                    if int(segment) <= 255:
                        path.append(segment)
                        backtrack(start + length, path)
                        path.pop()
        
        backtrack(0, [])
        return res
