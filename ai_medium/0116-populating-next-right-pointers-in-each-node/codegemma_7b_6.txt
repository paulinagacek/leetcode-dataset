class Solution:
    def connect(self, root: 'Optional[Node]') -> 'Optional[Node]':
        if not root: return root
        queue = [(root, 0)]
        prev_level = -1
        prev_node = None
        while queue:
            node, level = queue.pop(0)
            if level > prev_level:
                prev_level = level
                prev_node = None
            node.next = prev_node
            prev_node = node
            if node.left: queue.append((node.left, level + 1))
            if node.right: queue.append((node.right, level + 1))
        return root
