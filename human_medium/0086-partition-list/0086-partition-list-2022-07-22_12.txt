class Solution:
    def partition(self, head: Optional[ListNode], x: int) -> Optional[ListNode]:
        self.lessnodes = []
        self.greqnodes = []
        self.seperatenodes(head,x)
        head = self.joinnodes()
        return head
    
    def seperatenodes(self,head,x):
        while(head!=None):
            if(head.val<x):
                self.lessnodes.append(head)
            else:
                self.greqnodes.append(head)
            head = head.next
    
    def joinnodes(self):
        if self.lessnodes:
            tm = self.lessnodes[0]
            for i in range(len(self.lessnodes)-1):
                self.lessnodes[i].next = self.lessnodes[i+1]
            if self.greqnodes:
                self.lessnodes[-1].next = self.greqnodes[0]
                for i in range(len(self.greqnodes)-1):
                    self.greqnodes[i].next = self.greqnodes[i+1]
                self.greqnodes[-1].next = None
            else:
                self.lessnodes[-1].next = None
        else:
            if self.greqnodes:
                tm = self.greqnodes[0]
                for i in range(len(self.greqnodes)-1):
                    self.greqnodes[i].next = self.greqnodes[i+1]
                self.greqnodes[-1].next = None
            else:
                tm = None
        
        return tm
