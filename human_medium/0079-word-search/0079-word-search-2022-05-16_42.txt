class Solution:
    def exist(self, board: List[List[str]], word: str) -> bool:
        len_word = len(word)
        num_rows = len(board)
        num_cols = len(board[0])

        directions = [(0,1), (0,-1), (1,0), (-1,0)]
        visited = set()
        
        def is_in_grid(row, col):
            return 0 <= row < num_rows and 0 <= col < num_cols
            
        def dfs(row, col, char_index):
            # if find all characters in the word -> return True
            if char_index == len_word:
                return True
            
            # iterate curr cel neighbors
            for row_shift, col_shift in directions:
                n_row, n_col = row+row_shift, col+col_shift

                # if neighbor char equal to the next char in word, and is a unvisited cell
                if (n_row, n_col) not in visited and is_in_grid(n_row, n_col) and board[n_row][n_col] == word[char_index]:                   
                    # mark neighbor as visited
                    visited.add((n_row, n_col))
                    
                    # start a dfs search from the neighbor cell
                    if dfs(n_row, n_col, char_index + 1):                    
                        return True
                    
                    # if we didn\'t find the word using that neighbor cell, we can remove it from visited
                    visited.remove((n_row, n_col))
            
            return False
            
        # we iterate the board, starting a dfs search from each cell containing the first letter in the word
        for row in range(num_rows):
            for col in range(num_cols):                
                if board[row][col] == word[0]:
                    
                    visited.add((row,col))
                    
                    if dfs(row, col, 1):
                        return True
                    
                    visited.remove((row,col))

        return False
