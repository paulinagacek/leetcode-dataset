class Solution:
    def connect(self, root: \'Node\') -> \'Node\':
        if not root: return root
        queue = deque()
        queue.append(root)
        
        while queue:
            n = len(queue)
            
            prev = None
            for i in range(n):
                cur = queue.popleft()
                if prev: prev.next = cur
                
                if cur.left:
                    queue.append(cur.left)
                if cur.right:
                    queue.append(cur.right)
                
                prev = cur
        
        return root
