class Solution:
    def connect(self, root: \'Node\') -> \'Node\':
        levels = dict()
        
        def dfs(node, level=0):
            if node is None: return
            if level not in levels:
                levels[level] = []
            levels[level].append(node)
            dfs(node.left, level + 1)
            dfs(node.right, level + 1)
        
        dfs(root)
        for level in levels.values():
            for i in range(len(level)-1):
                level[i].next = level[i+1]
            level[-1].next = None
        return root
