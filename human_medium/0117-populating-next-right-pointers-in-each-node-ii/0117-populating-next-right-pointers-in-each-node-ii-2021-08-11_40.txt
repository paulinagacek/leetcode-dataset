class Solution(object):
    def connect(self, root):
        """
        :type root: Node
        :rtype: Node
        """
        prev_node, prev_level = None, -1
        queue = deque([(root, 0)])
        while queue:
            cur_node, cur_level = queue.popleft()
            if not cur_node: continue
            if prev_level == cur_level:
                prev_node.next= cur_node
            prev_node, prev_level = cur_node, cur_level
            queue.append((cur_node.left, cur_level+1))
            queue.append((cur_node.right, cur_level+1))
    
        return root
