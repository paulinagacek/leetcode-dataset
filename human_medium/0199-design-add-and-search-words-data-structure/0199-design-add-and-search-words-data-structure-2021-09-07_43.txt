# Reference : https://gist.github.com/ssshukla26/61e20eb50ff39bada6a9d121587f8e85

class TrieNode:
    def __init__(self):
        self.next = dict() # pointer to next node, starting with a key char
        self.end = False # by default false
        
class Trie:

    def __init__(self):
        """
        Initialize your data structure here.
        """
        self.root = TrieNode() # Make a TrieNode
        return

    def insert(self, word: str) -> None:
        """
        Inserts a word into the trie.
        """
        curr = self.root # start with root
        for char in word:
            # If char is not in next, add a new node to next
            if char not in curr.next:
                curr.next[char] = TrieNode()
            curr = curr.next[char] # point to next node
        curr.end = True # Mark end of word
        return
        
    def searchAbsolute(self, word: str, curr: TrieNode = None) -> bool:
        """
        Returns if the word is in the trie, with wild characters like "."
        """

        if not curr:
            curr = self.root # start with root

        for i,char in enumerate(word):

            # char is ".", search all nodes under the current node
            if char == ".":
                for next in curr.next.values():
                    if self.searchAbsolute(word[i+1:], next):
                        return True
                return False # if word not found, return false

            # If char in next, move to next
            elif char in curr.next:
                curr = curr.next[char] # point to next node

            # If char not in next, return false
            else:
                return False

        return curr.end # return end of word
    
class WordDictionary:

    def __init__(self):
        """
        Initialize your data structure here.
        """
        self.tree = Trie()
        return

    def addWord(self, word: str) -> None:
        self.tree.insert(word)
        return

    def search(self, word: str) -> bool:
        return self.tree.searchAbsolute(word)
        
# Your WordDictionary object will be instantiated and called as such:
# obj = WordDictionary()
# obj.addWord(word)
# param_2 = obj.search(word)
