"""
TrieNode class : It is representation of each TrieNode.

Trie class: It has related operations related to tries. (Note: The search is modified to handle the regex matching)

"""
from collections import defaultdict

class TrieNode:
    def __init__(self):
        self.children = defaultdict(list)
        self.isWord = False

class Trie:
    def __init__(self):
        self.root = TrieNode()
        
    def insert(self, word):
        root = self.root
        for w in word:
            if w not in root.children:
                root.children[w] = TrieNode()
            root = root.children[w]
        root.isWord = True
    
    def search(self, root, word):
        for i in range(len(word)):
            if word[i] != \'.\':
                if word[i] in root.children:
                    root = root.children[word[i]]
                else:
                    return False
            else:
				#If the present char is a \'.\' then I visit all the children nodes in DFS manner to find match
                visitAll = root.children
                for child in visitAll:
                    if self.search(root.children[child], word[i+1:]):
                        return True
                return False
        return (root.isWord == True)


class WordDictionary(object):
    def __init__(self):
        self.trie = Trie()
        self.root = self.trie.root

    def addWord(self, word):
        self.trie.insert(word)
    
    def search(self, word):
        return self.trie.search(self.root, word)
