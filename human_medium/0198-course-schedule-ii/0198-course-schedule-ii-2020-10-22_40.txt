class Solution:
    def findOrder(self, numCourses: int, prerequisites: List[List[int]]) -> List[int]:
        in_degrees = [0 for x in range(numCourses)]
        start_nodes = []
        adj_matrix = defaultdict(list)
        for edge in prerequisites:
            in_degrees[edge[0]] += 1
            adj_matrix[edge[1]].append(edge[0])
        
        for course_id, in_degree in enumerate(in_degrees):
            if in_degree == 0:
                start_nodes.append(course_id)
        
        if len(start_nodes) == 0:
            return []
        
        # bfs 
        visited = OrderedDict()
        for start_node in start_nodes:
            queue = [start_node]
            while queue:
                current = queue.pop()
                visited[current] = True
                for child in adj_matrix[current]:
                    if child in visited:
                        continue
                    in_degrees[child] -= 1
                    if in_degrees[child] < 1:
                        queue.append(child)
                        
        if len(visited) != numCourses:
            return []
        
        return list(visited.keys())
