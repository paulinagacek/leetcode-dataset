class Solution:
    def findOrder(self, numCourses: int, prerequisites: List[List[int]]) -> List[int]:
        graph, in_degree = defaultdict(list), [0] * numCourses

        for u, v in prerequisites:
            graph[v].append(u)
            in_degree[u] += 1

        queue = deque(n for n, d in enumerate(in_degree) if d == 0)

        output, visited_courses = [], 0

        while queue:
            output.append((cur := queue.popleft()))
            visited_courses += 1

            for nxt in graph[cur]:
                in_degree[nxt] -= 1

                if in_degree[nxt] == 0:
                    queue.append(nxt)

        return output if visited_courses == numCourses else []
