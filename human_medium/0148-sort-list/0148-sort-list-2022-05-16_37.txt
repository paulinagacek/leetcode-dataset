class Solution:
    def sortList(self, head: Optional[ListNode]) -> Optional[ListNode]:
        if not head:
            return head
        
        def divide(head):
            left = slow = fast = head
            fast = fast.next
            while fast and fast.next:
                slow = slow.next
                fast = fast.next.next
                
            right = slow.next
            slow.next = None           

            return left, right
        
        def merge(l1, l2):
            dummy = cur = ListNode(0)
            while l1 and l2:
                if l1.val < l2.val:
                    cur.next = l1
                    l1 = l1.next
                else:
                    cur.next = l2
                    l2 = l2.next
                cur = cur.next

            cur.next = l1 or l2
            return dummy.next
    
        def sort_list(head):   
            if not head or not head.next:
                return head
            
            left, right = divide(head)

            left = sort_list(left)
            right = sort_list(right)
            
            return merge(left, right)
            
        return sort_list(head)
