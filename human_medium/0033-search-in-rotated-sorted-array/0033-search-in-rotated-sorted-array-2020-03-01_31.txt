class Solution:
    def __init__(self):
        self._lesser = None
        self._limit = None
    
    
    def _get_value(self, x):
        if self._lesser:
            return -math.inf if x >= self._limit else x
        else:
            return math.inf if x< self._limit else x
    
    def search(self, nums: List[int], target: int) -> int:
        n = len(nums)
        if n == 0:
            return -1
       
        self._limit = nums[0]  
        self._lesser = True if target < nums[0] else False
        
        lo = 0
        hi = n - 1
        
        while lo <= hi:
            
            mid = lo + (hi - lo) // 2
            
            if target > self._get_value(nums[mid]):
                lo = mid + 1
            elif target < self._get_value(nums[mid]):
                hi = mid - 1
            else:
                return mid
        return -1
