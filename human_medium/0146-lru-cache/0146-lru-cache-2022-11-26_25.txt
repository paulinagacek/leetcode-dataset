class Node:
    def __init__(self, key, val):
        self.key  = key
        self.val = val
        self.next = None
        self.prev  = None

class DlinkedList:
    def __init__(self):
        self.head = None
        self.tail = None
    def add_node(self, node):
        # adding a node at the tail of linkedlist
        # Doubly linkedlist is empty
        if self.head is None:
            self.head = self.tail = node
        #  Doubly linkedlist is not empty
        else:
            self.tail.next = node
            node.prev  = self.tail
            self.tail = node
            
    def del_node(self, node):
        # deleting the node 
        next_item = node.next
        prev_item = node.prev
        if prev_item:
            prev_item.next = next_item
        if next_item:
            next_item.prev = prev_item
        if self.head == node:
            self.head = next_item
        if self.tail == node:
            self.tail = prev_item

class LRUCache:

    def __init__(self, capacity: int):
        self.capacity = capacity
        self.store  = dict()
        self.dd = DlinkedList()
    
    def get(self, key: int) -> int:
        if key in self.store:
            # recently used item is added to tail side of linkedlist
            get_node = self.store[key]
            
            # delete this node from dd and store
            self.dd.del_node(get_node)
            del self.store[key]
            
            # add to store and dd
            self.store[key] = Node(key,get_node.val)
            self.dd.add_node(self.store[key])
            return get_node.val
        else:
            return -1
            
    def put(self, key: int, value: int) -> None:
        if key in self.store:
            #  deleting (key, value) from linkedlist and as well from hashmap
            self.dd.del_node(self.store[key])
            del self.store[key]
            
        if len(self.store) == self.capacity and key not in self.store:
            # if capacity id full, removing from head side of linkedlist as well from hash map
            del self.store[self.dd.head.key]
            self.dd.del_node(self.dd.head)
        # adding key and node to hash map and linkedlist    
        new_node = Node(key,value)
        self.store[key] = new_node
        
        self.dd.add_node(new_node)
