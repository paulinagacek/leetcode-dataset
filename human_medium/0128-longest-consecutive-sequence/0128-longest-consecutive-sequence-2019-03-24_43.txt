class Solution:
    def longestConsecutive(self, nums: List[int]) -> int:
        union = UnionFind(nums)
        output = len(nums)
        for i in range(len(nums)):
            left = union.find_parent(nums[i]-1)
            right = union.find_parent(nums[i]+1)
            if left == None and right == None:
                union.parent[nums[i]] = nums[i]
            elif left == None:
                union.union(nums[i], right)
            elif right == None:
                union.union(nums[i], left)
            else:
                union.union(nums[i], right)
                union.union(left, right)
            # print(union.parent, left, right)
        
        ctr = Counter()
        for i in union.parent.values():
            ctr[i] += 1
        
        return 0 if list(ctr) == [] else max(list(ctr.values()))
