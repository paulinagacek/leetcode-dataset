class Solution:
    def longestConsecutive(self, nums: List[int]) -> int:
        graph = defaultdict(list)
        for num in nums:
            found = False
            if num-1 in graph:
                graph[num-1].append(num)
                graph[num].append(num-1)
                found = True
            if num+1 in graph:
                graph[num+1].append(num)
                graph[num].append(num+1)
                found = True
            if not found:
                graph[num] = []

        
        def dfs(node):
            nonlocal size
            visited.add(node)
            for neighbor in graph[node]:
                if neighbor not in visited:
                    size += 1
                    dfs(neighbor)

        visited = set()
        longest = 0
        for num in nums:
            if num not in visited:
                size = 1
                dfs(num)
                longest = max(longest, size)

        return longest
