class Solution:
    def longestConsecutive(self, nums: List[int]) -> int:
        hashmap = {}
        idx = 0
        for i, num in enumerate(nums):  # we don\'t care about duplicated numbers
            if num not in hashmap:
                hashmap[num] = idx
                idx += 1 # reassign each unique number a new index to make it easier to construct disjoint set
        uf = UnionFind(len(hashmap))
        for num in hashmap:
            i = hashmap[num]
            next = num + 1
            prev = num - 1
            if next in hashmap:
                uf.union(hashmap[next], i)
            if prev in hashmap:
                uf.union(hashmap[prev], i)
        return uf.getcount()
