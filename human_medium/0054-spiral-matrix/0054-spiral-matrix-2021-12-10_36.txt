class Solution:
    def spiralOrder(self, matrix: List[List[int]]) -> List[int]:
        
        result = []
        
        while matrix:
            top = matrix.pop(0)
            bottom = matrix.pop() if matrix else None
            left = []
            right = []  
            middle = []
            
            if matrix:
                if len(matrix[0]) > 1:
                    for row in matrix:
                        left.append(row[0])
                        right.append(row[-1])
                        row.pop(0)
                        row.pop()
                else:
                    if matrix[0]:
                        for [value] in matrix:
                            middle.append(value)
                    matrix = None
            
            result += top
            
            if middle:
                result += (middle)
            if right:
                result += right
            if bottom:
                result += reversed(bottom)
            if left:
                result += reversed(left)
                    
                    
        return result
