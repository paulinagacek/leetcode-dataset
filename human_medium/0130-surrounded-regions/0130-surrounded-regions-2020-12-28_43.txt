class Solution:
    def solve(self, board: List[List[str]]) -> None:
        """
        Do not return anything, modify board in-place instead.
        """
        if not board:
            return []
        
        # Preserve Board
        # Converts each SAFE Cells
        # To \'R\' for RESERVED
        self.preserve(board)
        
        # Convert each cell that is still O
        # To X since not SAFE
        for i in range(len(board)):
            for j in range(len(board[i])):
                if board[i][j] == \'O\':
                    board[i][j] = \'X\'
        
        # Convert safe cells or RESERVED cells
        # to O since they are safe!
        for i in range(len(board)):
            for j in range(len(board[i])):
                if board[i][j] == \'R\':
                    board[i][j] = \'O\'
        
        return board
        
    # Preserve/Reserve CELLS!
    def preserve(self, board):
        #                                       _
        # Look for left,right,top,bottom lines |_|
        
        # Left and Right
        for i in range(len(board)):
            if board[i][0] == \'O\':
                self.preserveRegion(board,i,0)
                
            if board[i][-1] == \'O\':
                self.preserveRegion(board,i,len(board[i])-1)
                
        # Top and Bottom
        for i in range(len(board[0])):
            if board[0][i] == \'O\':
                self.preserveRegion(board,0,i)    
            
            if board[-1][i] == \'O\':
                self.preserveRegion(board,len(board)-1,i)
                
                
    # Do a DFS Search on the region
    # To search for each O and convert
    # it to a safe/reserved region or R
    def preserveRegion(self,board,row,col):
        if not (row>=0 and col>=0 and row<len(board) and col<len(board[row])):
            return
        
        if board[row][col] != \'O\':
            return
        
        # RESERVE CHAR \'R\'
        board[row][col] = \'R\'
        self.preserveRegion(board,row+1,col) # Up
        self.preserveRegion(board,row-1,col) # Down
        self.preserveRegion(board,row,col+1) # Right
        self.preserveRegion(board,row,col-1) # Left
