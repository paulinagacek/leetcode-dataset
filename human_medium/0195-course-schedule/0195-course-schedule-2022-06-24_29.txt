class Solution:
    def canFinish(self, num: int, pre: List[List[int]]) -> bool:
        graph = defaultdict(list)
        for p in pre :
            graph[p[0]].append(p[1])
        visit = [0 for i in range(num)]
        def dfs(v) :
            if visit[v] == 1 :
                return False
            if visit[v] == 2 :
                return True
            visit[v] = 1
            for n in graph[v] :
                if not dfs(n) : return False
            visit[v] = 2
            return True
        
        for v in range(num) :
            if not dfs(v) : return False
        return True
