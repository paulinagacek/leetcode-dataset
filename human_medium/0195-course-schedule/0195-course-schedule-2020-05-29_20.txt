class Solution:
    def canFinish(self, numCourses: int, prerequisites: List[List[int]]) -> bool:

        # 0: unlearned, 1: learning, 2: learned
        self.course_status = [0] * numCourses

        # Use dict to store all advanced courses
        self.adv_dict = collections.defaultdict(list)
        for adv, base in prerequisites:
            self.adv_dict[base].append(adv)

        for course in range(numCourses):
            if not self.dfs(course): return False
        return True

    def dfs(self, course):
        if self.course_status[course] == 2:
            return True
        if self.course_status[course] == 1:
            return False
		
		# Start to learn this course
        self.course_status[course] = 1
        for adv in self.adv_dict[course]:
            if not self.dfs(adv): return False
            
        # Mark the course as learned
        self.course_status[course] = 2
        return True
