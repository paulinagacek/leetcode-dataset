class Solution:
    def canFinish(self, numCourses: int, prerequisites: List[List[int]]) -> bool:
        if numCourses == 0:
            return True
        adj_list = {}
    
        indegrees = [0 for i in range(numCourses)]
        
        for req in prerequisites:
            in_ = req[0]
            out = req[1]
            indegrees[in_]+=1
            
            if out not in adj_list:
                adj_list[out] = []
            
            adj_list[out].append(in_)
        
        q = []
        
        for i in range(numCourses):
            if indegrees[i]==0:
                q.append(i)
        
        while q:
            curr = q.pop(0)
            edges = adj_list.get(curr)
            if not edges:
                continue
            for edge in edges:
                indegrees[edge]-=1
                
                if (indegrees[edge] ==0):
                    q.append(edge)
                    
        for i in range(numCourses):
            if indegrees[i]!=0:
                return False
        return True
